<!DOCTYPE HTML>

<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" value="width=device-width, initial-scale=1.0, user-scalable=yes">
        <meta name="description" value="# SSL on IP Address

You know, because of $WORK and a few other things, I have to set up public facing server which serves SSL thingy.
Though we only have a single public IP with no domain attached on">
        <meta name="author" value="Ibnu D. Aji">
        <link rel="stylesheet" type="text/css" href="static/css/milligram.min.css">
        <title>
            Nothing Unusual - SSL on IP Address
        </title>
    </head>
    <body>
        <main class="wrapper">
            <nav class="navigation">
                <section class="container">
                    <a class="navigation-title" href="index.html">
                        Home
                    </a>
                    <ul class="navigation-list float-right">
                        <li class="navigation-item">
                            <a href="2018-03-31-cv.html" class="navigation-link">
                                CV
                            </a>
                            <a href="2018-01-01-about.html" class="navigation-link">
                                About
                            </a>
                        </li>
                    </ul>
                </section>
            </nav>
            <section class="container">
                <h1>SSL on IP Address</h1><p>You know, because of $WORK and a few other things, I have to set up public facing server which serves SSL thingy.
Though we only have a single public IP with no domain attached on it, we can still use it.
Furthermore, it actually only takes a few easy steps.</p><ol><li>Generate certificates.</li><li>Set nginx.</li><li>???</li><li>Profit.</li></ol><h3>Generate Certificates</h3><p>I took the easiest path by using owntrack' <a href="https://github.com/owntracks/tools/blob/master/TLS/generate-CA.sh">script</a>
to generate those certs and its friends.</p><p>In the script above, I just modified a few lines, for example,</p><pre><code>IPLIST=&quot;255.255.255.255&quot;
CA_ORG='/O=your.company.or.whatever/OU=generate-ca/emailAddress=something@something.com'
</code></pre><p>On <code>$IPLIST</code>, i just put our public IP, while on <code>$CA_ORG</code>, I just put some relevant information.</p><p>And then issued <code>bash generate.sh</code> followed by moving those certs to <code>/etc/nginx/ssl/</code> dir.</p><h3>Set nginx</h3><p>I just assumed that you already have installed nginx on your server.
Okay, then I edited <code>/etc/nginx/sites-enabled/$PUBLIC_IP</code> to something along this line.</p><pre><code># file $YOUR_PUBLIC_IP
server {
    listen              8443;
    ssl                 on;
    ssl_certificate     /etc/nginx/ssl/$YOUR_PUBLIC_IP.crt;
    ssl_certificate_key /etc/nginx/ssl/$YOUR_PUBLIC_IP.key;
    server_name         $YOUR_PUBLIC_IP;
    location / {
        proxy_pass  http://127.0.0.1:5000/;
    }
}
</code></pre><p>On that <code>server</code> block, we tell nginx to</p><ul><li>Listen to port 8443.</li><li>Use SSL encryption thingy.</li><li>Use the generated certs by OwnTracks' <code>generate.sh</code></li><li>Name of the server is <code>$YOUR_PUBLIC_IP</code>.</li><li>And we will redirect all requests to a running web app at port 5000.</li></ul><p>I swear on me mum's name, mate, Nginx's configuration file is much nicer than Apache HTTPD's.
That's just a personal taste, though.</p><h3>???</h3><p>(Re)Start the nginx service / daemon.</p><h3>Profit</h3><p>Fire up your browser and open <code>https://$YOUR_PUBLIC_IP</code>. You will be greeted by ssl warning.
Just accept it.
Sometimes, you have to trust and believe in yourself.</p>
            </section>
        </main>
    </body>
    <footer>
        This material is shared under the 
        <a href="https://creativecommons.org/licenses/by/4.0">
            CC-BY License.
        </a>
    </footer>
</html>
